CREATE DATABASE TEST;
USE TEST;

CREATE TABLE VEHICULOS (
    MARCA VARCHAR(32) NOT NULL,
    MODELO VARCHAR(32) NOT NULL,
    PRECIO FLOAT NOT NULL,
    KILOMETRAJE FLOAT NOT NULL,
    COLOR VARCHAR(16) NOT NULL,
    PLACA VARCHAR(6) NOT NULL,
    DISPONIBLE BOOL NOT NULL,
    PROPIETARIO VARCHAR(3) NOT NULL,
    PUERTAS INT NOT NULL,
    
    PRIMARY KEY (PLACA)
);

INSERT INTO VEHICULOS VALUES ("MOTO", "A1", 80210.234, 0.0, "NEGRO", "123ABC", true, "NIX", 0);
INSERT INTO VEHICULOS VALUES ("MOTO", "A2", 80110.234, 0.0, "BLANCO", "143ABC", false, "DAN", 0);
INSERT INTO VEHICULOS VALUES ("MOTO", "A3", 834210.234, 0.0, "NEGRO", "125ABC", true, "DAN", 0);
INSERT INTO VEHICULOS VALUES ("MOTO", "A4", 80213210.234, 0.0, "AZUL", "123SBC", true, "SAM", 0);
INSERT INTO VEHICULOS VALUES ("MOTO", "A5", 8021032234, 0.0, "NEGRO", "113AVC", false, "NIX", 0);

INSERT INTO VEHICULOS VALUES ("FERRARI", "A1", 80210.234, 0.0, "NEGRO", "113ABD", true, "DAN", 2);
INSERT INTO VEHICULOS VALUES ("FERRARI", "B1", 110210.234, 0.0, "AMARILLO", "133AHC", false, "MAR", 2);
INSERT INTO VEHICULOS VALUES ("FERRARI", "C1", 8423210.234, 0.0, "NEGRO", "343ABC", true, "SAM", 2);
INSERT INTO VEHICULOS VALUES ("FERRARI", "F1", 802321.24, 0.0, "ROJO", "213ABC", false, "DAN", 2);
INSERT INTO VEHICULOS VALUES ("FERRARI", "N1", 8021210.4, 0.0, "BLANCO", "121JBC", true, "SAM", 2);

INSERT INTO VEHICULOS VALUES ("BUS", "A1", 80210.234, 0.0, "NEGRO", "453ABC", false, "DAN", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A2", 80110.234, 0.0, "BLANCO", "843ABC", true, "MAR", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A3", 834210.234, 0.0, "NEGRO", "725ABC", false, "SAM", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A4", 80213210.234, 0.0, "AZUL", "163SBC", true, "NIX", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A5", 8021032234, 0.0, "NEGRO", "113AVT", true, "NIX", 4);

INSERT INTO VEHICULOS VALUES ("FERRARI", "A1", 80210.234, 0.0, "NEGRO", "113AKD", true, "DAN", 2);
INSERT INTO VEHICULOS VALUES ("FERRARI", "B1", 110210.234, 0.0, "AMARILLO", "139AHC", true, "NIX", 2);
INSERT INTO VEHICULOS VALUES ("FERRARI", "C1", 8423210.234, 0.0, "NEGRO", "343XBC", false, "NIX", 2);
INSERT INTO VEHICULOS VALUES ("MOTO", "F1", 802321.24, 0.0, "ROJO", "213PBC", true, "MAR", 0);
INSERT INTO VEHICULOS VALUES ("MOTO", "N1", 8021210.4, 0.0, "BLANCO", "521JXC", true, "DAN", 0);

INSERT INTO VEHICULOS VALUES ("BUS", "A1", 80210.234, 0.0, "NEGRO", "1343ABC", false, "NIX", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A1", 80210.234, 0.0, "NEGRO", "123HJC", true, "DAN", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A1", 80210.234, 0.0, "NEGRO", "563ABC", false, "MAR", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A1", 80210.234, 0.0, "NEGRO", "173AKL", true, "SAM", 4);
INSERT INTO VEHICULOS VALUES ("BUS", "A1", 80210.234, 0.0, "NEGRO", "233FVC", false, "DAN", 4);

-- 3. Consultar EL vehiculos mas costoso
SELECT * FROM VEHICULOS WHERE PRECIO=(SELECT MAX(PRECIO) FROM VEHICULOS);

-- 4. Cantidad buses vendidos
SELECT COUNT(*) FROM VEHICULOS WHERE MARCA="BUS" AND DISPONIBLE=false;

-- 5. Cantidad de motos disponibles
SELECT COUNT(*) FROM VEHICULOS WHERE MARCA="MOTO" AND DISPONIBLE=true;

-- 6. Mejor cliente ###
SELECT PROPIETARIO, COUNT(PROPIETARIO) FROM VEHICULOS ORDER BY COUNT(PROPIETARIO) DESC LIMIT 1;

-- 7. Promedio valor motos 
SELECT AVG(PRECIO) FROM VEHICULOS WHERE MARCA="MOTO";

-- 8. Cantidad vehiculos 4 puertas
SELECT COUNT(*) FROM VEHICULOS WHERE PUERTAS=4;

-- 9. El vehiculo mas barato
SELECT * FROM VEHICULOS WHERE PRECIO=(SELECT MIN(PRECIO) FROM VEHICULOS);

-- 10. Placa de los vehiculos deportivos
SELECT * FROM VEHICULOS WHERE MARCA="FERRARI";